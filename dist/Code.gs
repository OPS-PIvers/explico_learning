(()=>{"use strict";!function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var e=function(e){return e.IMAGE="image",e.VIDEO="video",e.YOUTUBE="youtube",e}({}),t=function(e){return e.TEXT_POPUP="text_popup",e.PAN_ZOOM="pan_zoom",e.SPOTLIGHT="spotlight",e.TEXT_ON_IMAGE="text_on_image",e}({}),r=function(e){return e.CLICK="click",e.HOVER="hover",e.TOUCH="touch",e.AUTO="auto",e}({}),o=function(e){return e.FADE_IN="fadeIn",e.SLIDE_UP="slideUp",e.SLIDE_DOWN="slideDown",e.SLIDE_LEFT="slideLeft",e.SLIDE_RIGHT="slideRight",e.BOUNCE="bounce",e.ZOOM_IN="zoomIn",e.ZOOM_OUT="zoomOut",e}({});function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function n(e,t,r){return(t=function(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}n(n(n(n({},t.TEXT_POPUP,{name:"Text Popup",description:"Show text in a popup overlay",icon:"üí¨",requiredFields:["text"],optionalFields:["title","backgroundColor","textColor","animation"]}),t.PAN_ZOOM,{name:"Pan & Zoom",description:"Pan and zoom to a specific area",icon:"üîç",requiredFields:["panZoomConfig"],optionalFields:["duration","easing"]}),t.SPOTLIGHT,{name:"Spotlight",description:"Highlight an area with spotlight effect",icon:"üí°",requiredFields:["spotlightConfig"],optionalFields:["duration","animation"]}),t.TEXT_ON_IMAGE,{name:"Text on Image",description:"Overlay text directly on the image",icon:"üìù",requiredFields:["text"],optionalFields:["fontSize","fontFamily","textColor","backgroundColor"]}),n(n(n(n({},r.CLICK,{name:"Click",description:"Trigger on mouse click or tap",icon:"üëÜ",supportedDevices:["desktop","mobile","tablet"]}),r.HOVER,{name:"Hover",description:"Trigger on mouse hover (desktop only)",icon:"üñ±Ô∏è",supportedDevices:["desktop"]}),r.TOUCH,{name:"Touch",description:"Trigger on touch (mobile/tablet only)",icon:"üëã",supportedDevices:["mobile","tablet"]}),r.AUTO,{name:"Auto",description:"Trigger automatically after delay",icon:"‚è∞",supportedDevices:["desktop","mobile","tablet"]}),n(n(n({},e.IMAGE,{name:"Image",description:"Static image file",icon:"üñºÔ∏è",supportedFormats:["jpg","jpeg","png","gif","webp"],maxSize:"10MB"}),e.VIDEO,{name:"Video",description:"Video file",icon:"üé•",supportedFormats:["mp4","webm","ogg"],maxSize:"100MB"}),e.YOUTUBE,{name:"YouTube",description:"YouTube video",icon:"üìπ",supportedFormats:["youtube.com","youtu.be"],maxSize:"N/A"}),n(n(n(n(n(n(n(n({},o.FADE_IN,{name:"Fade In",description:"Gradually fade in",duration:500,easing:"ease-out"}),o.SLIDE_UP,{name:"Slide Up",description:"Slide in from bottom",duration:400,easing:"ease-out"}),o.SLIDE_DOWN,{name:"Slide Down",description:"Slide in from top",duration:400,easing:"ease-out"}),o.SLIDE_LEFT,{name:"Slide Left",description:"Slide in from right",duration:400,easing:"ease-out"}),o.SLIDE_RIGHT,{name:"Slide Right",description:"Slide in from left",duration:400,easing:"ease-out"}),o.BOUNCE,{name:"Bounce",description:"Bounce in effect",duration:600,easing:"cubic-bezier(0.68, -0.55, 0.265, 1.55)"}),o.ZOOM_IN,{name:"Zoom In",description:"Scale up from center",duration:400,easing:"ease-out"}),o.ZOOM_OUT,{name:"Zoom Out",description:"Scale down to center",duration:400,easing:"ease-in"}),t.TEXT_POPUP,r.CLICK,o.FADE_IN;var a={settings:{autoSave:!0,version:"1.0.0",theme:"light",analytics:!0}};function s(e){try{var t=SpreadsheetApp.create("".concat(e," - Explico Data")),r=t.getId();return function(e){try{var t=e.getActiveSheet();t.setName("Projects"),t.getRange(1,1,1,7).setValues([["ID","Title","Description","Created","Updated","SpreadsheetId","Settings"]]),e.insertSheet("Slides").getRange(1,1,1,8).setValues([["ID","ProjectID","Order","Title","MediaType","MediaURL","Duration","Transition"]]),e.insertSheet("Hotspots").getRange(1,1,1,11).setValues([["ID","SlideID","X","Y","Width","Height","EventType","TriggerType","Config","Order","Visible"]]),e.insertSheet("Analytics").getRange(1,1,1,6).setValues([["ID","ProjectID","SlideID","HotspotID","Timestamp","Action"]]),Logger.log("Spreadsheet structure created successfully")}catch(e){var r=e instanceof Error?e.message:String(e);throw Logger.log("setupSpreadsheetStructure error: "+r),new Error("Failed to set up spreadsheet structure: "+r)}}(t),Logger.log("Created spreadsheet: ".concat(r," for project: ").concat(e)),r}catch(e){var o=e instanceof Error?e.message:String(e);throw Logger.log("createProjectSpreadsheet error: "+o),new Error("Failed to create project spreadsheet: "+o)}}globalThis.doGet=function(e){var t=e.parameter.page||"dashboard",r=e.parameter.project;try{switch(t){case"dashboard":return HtmlService.createTemplateFromFile("main-app").evaluate().setTitle("Explico Learning - Projects").setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);case"editor":if(!r)throw new Error("Project ID required for editor");var o=HtmlService.createTemplateFromFile("editor-template");return o.projectId=r,o.evaluate().setTitle("Explico Learning - Editor").setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);default:throw new Error("Unknown page: ".concat(t))}}catch(e){var i=e instanceof Error?e.message:String(e);return Logger.log("doGet error: "+i),HtmlService.createHtmlOutput('\n      <div style="padding: 20px; text-align: center; color: #721c24; background: #f8d7da; margin: 20px; border-radius: 4px;">\n        <h2>üö´ Application Error</h2>\n        <p>Error: '.concat(i,'</p>\n        <button onclick="window.location.reload()" style="padding: 8px 16px; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer;">\n          Reload Page\n        </button>\n      </div>\n    '))}},globalThis.include=function(e){return HtmlService.createHtmlOutputFromFile(e).getContent()},globalThis.getProjects=function(){try{return[{id:"sample-project-1",title:"Sample Project",description:"This is a sample project created during TypeScript migration",createdAt:new Date,updatedAt:new Date,spreadsheetId:"sample-spreadsheet-id",settings:a.settings}]}catch(t){var e=t instanceof Error?t.message:String(t);throw Logger.log("getProjects error: "+e),new Error("Failed to load projects: "+e)}},globalThis.createProject=function(e,t){try{var r="proj_".concat(Utilities.getUuid()),o={id:r,title:e.trim(),description:t.trim(),createdAt:new Date,updatedAt:new Date,spreadsheetId:s(e),settings:a.settings};return Logger.log("Created project: ".concat(r)),o}catch(e){var i=e instanceof Error?e.message:String(e);throw Logger.log("createProject error: "+i),new Error("Failed to create project: "+i)}},globalThis.deleteProject=function(e){try{Logger.log("Deleted project: ".concat(e))}catch(e){var t=e instanceof Error?e.message:String(e);throw Logger.log("deleteProject error: "+t),new Error("Failed to delete project: "+t)}},globalThis.getProjectData=function(e){try{return{project:{id:e,title:"Sample Project",description:"Sample project for testing",createdAt:new Date,updatedAt:new Date,spreadsheetId:"sample-spreadsheet",settings:a.settings},slides:[{id:"slide-1",projectId:e,title:"Sample Slide",mediaType:"image",mediaUrl:"https://via.placeholder.com/800x600/007bff/ffffff?text=Sample+Image",order:0,transition:"fade"}],hotspots:[]}}catch(e){var t=e instanceof Error?e.message:String(e);throw Logger.log("getProjectData error: "+t),new Error("Failed to load project data: "+t)}},globalThis.saveHotspots=function(e,t){try{Logger.log("Saved ".concat(t.length," hotspots for project: ").concat(e))}catch(e){var r=e instanceof Error?e.message:String(e);throw Logger.log("saveHotspots error: "+r),new Error("Failed to save hotspots: "+r)}},globalThis.saveSlides=function(e,t){try{Logger.log("Saved ".concat(t.length," slides for project: ").concat(e))}catch(e){var r=e instanceof Error?e.message:String(e);throw Logger.log("saveSlides error: "+r),new Error("Failed to save slides: "+r)}}})();